<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSVP</title>

    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css?family=Ms+Madi" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Content" rel="stylesheet">

    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Load your private config (NOT tracked by GitHub) -->
    <script src="../supabase_config.js"></script>

</head>
<body>
    <nav class="nav-container">
        <button id="menuToggle" aria-expanded="false" aria-controls="quickLinks">Menu ▾</button>
        <div id="quickLinks" class="quick-links" hidden>
            <a href="../index.html">Home</a>
            <a href="donations.html">Gifts/Donations</a>
            <a href="FAQ.html">FAQ</a>
        </div>
    </nav>
    <h1>RSVP to Our Wedding</h1>

    <img src="../image_folder/DSC_0199.JPG" id="rsvpImages" alt="Engagement Photo" style="width:400px;height:auto;">
    <p id="rsvp_message">We are looking forward to seeing you all on our special day! Please RSVP below by April 14th, 2026. 
    We hope to see you there!</p>

<main>
    <button id="open_rsvp" onclick="openRSVPModal()">RSVP Now</button>

    <div id="rsvp_modal" style="display:none;">
        <div class="modal-content">
            <span onclick="closeRSVPModal()" style="cursor:pointer; float:right; font-size:1.5em;">&times;</span>

            <h2>RSVP to Our Wedding</h2>

            <form id="rsvpForm">
                <label>Name *:
                    <input type="text" id="name" required>
                </label>

                <label>Plus One:
                    <input type="text" id="plus_one">
                </label>

                <label>Email *:
                    <input type="email" id="email" required>
                </label>

                <label>Dietary Restrictions:
                    <input type="text" id="dietary">
                </label>

                <label>Will you attend?
                    <select id="attendance" required>
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                </label>

                <button type="submit">Submit RSVP</button>
            </form>

            <div id="rsvp_message" style="margin-top:10px;"></div>
        </div>
    </div>
</main>

</body>
<footer>
    <p>&copy; 2026 Meranda and Nikko Wedding</p>
</footer>

<script>
// Modal open/close functions
function openRSVPModal() {
    document.getElementById("rsvp_modal").style.display = "block";
}

function closeRSVPModal() {
    document.getElementById("rsvp_modal").style.display = "none";
}

// Main script
document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("rsvpForm");
    const messageDiv = document.getElementById("rsvp_message");

    // Initialize Supabase client
    const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);

    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const entry = {
            name: document.getElementById("name").value,
            plus_one: document.getElementById("plus_one").value,
            email: document.getElementById("email").value,
            attendance: document.getElementById("attendance").value,
            dietary: document.getElementById("dietary").value
        };

        // Insert into Supabase
        const { data, error } = await supabaseClient
            .from(supabaseTable)
            .insert([entry]);

        if (error) {
            console.error(error);
            messageDiv.textContent = "❌ There was an error submitting your RSVP." + error.message;
            return;
        }

        // Success!
        messageDiv.textContent = "✔ Thank you! Your RSVP has been received.";
        form.reset();

        // Optional close after 9 second
        setTimeout(closeRSVPModal, 9000);
    });
});
</script>

<script src="../scripts.js"></script>

</body>
</html>
